<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Allometry database harmonization • traits4models</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Allometry database harmonization">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">traits4models</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><h6 class="dropdown-header" data-toc-skip>Data preparation</h6></li>
    <li><a class="dropdown-item" href="../articles/TraitDatabaseHarmonization.html">Trait database harmonization</a></li>
    <li><a class="dropdown-item" href="../articles/AllometryDatabaseHarmonization.html">Allometry database harmonization</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Building species parameter tables</h6></li>
    <li><a class="dropdown-item" href="../articles/SpeciesParameterizationMEDFATE.html">Building species parameter tables for medfate</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/emf-creaf/traits4models/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Allometry database harmonization</h1>
                        <h4 data-toc-skip class="author">Miquel De
Cáceres / Nicolas Martin-StPaul</h4>
            
            <h4 data-toc-skip class="date">2024-09-05</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/emf-creaf/traits4models/blob/HEAD/vignettes/AllometryDatabaseHarmonization.Rmd" class="external-link"><code>vignettes/AllometryDatabaseHarmonization.Rmd</code></a></small>
      <div class="d-none name"><code>AllometryDatabaseHarmonization.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<div class="section level3">
<h3 id="required-packages">Required packages<a class="anchor" aria-label="anchor" href="#required-packages"></a>
</h3>
<p>Assuming we have <strong>traits4models</strong> installed, we load it
and other common packages that we will employ in this vignette:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://emf-creaf.github.io/traits4models/">traits4models</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org" class="external-link">readr</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-dataset">Example dataset<a class="anchor" aria-label="anchor" href="#example-dataset"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">DB_path</span> <span class="op">&lt;-</span> <span class="st">"~/OneDrive/EMF_datasets/AllometryDatabases/"</span></span>
<span><span class="va">db</span> <span class="op">&lt;-</span> <span class="fu">openxlsx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html" class="external-link">read.xlsx</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"Sources/TreeAllometries/TreeAllometries.xlsx"</span><span class="op">)</span>,</span>
<span>                                 sheet<span class="op">=</span> <span class="st">"Tree_CR_models"</span><span class="op">)</span></span></code></pre></div>
<p>The data looks as follows:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db</span></span></code></pre></div>
<pre><code><span><span class="co">##               Name    a_cr     b_1cr     b_2cr        b_3cr     c_1cr    c_2cr</span></span>
<span><span class="co">## 1       Abies alba 2.36476 -0.763000 -0.022850  0.000074049 -0.010180 -0.27004</span></span>
<span><span class="co">## 2  Fagus sylvatica 3.85373 -0.743000 -0.024680  0.000135686  0.000000 -0.38434</span></span>
<span><span class="co">## 3      Pinus nigra 2.26205  0.000000 -0.019340  0.000000000 -0.013730 -0.44909</span></span>
<span><span class="co">## 4 Pinus sylvestris 1.50576 -0.706481 -0.078039  0.000182000 -0.007262  0.00000</span></span>
<span><span class="co">## 5          Quercus 1.98539 -0.552000 -0.013860 -0.000110736 -0.006850 -0.20101</span></span>
<span><span class="co">## 6            Abies 2.36476 -0.763000 -0.022850  0.000074049 -0.010180 -0.27004</span></span>
<span><span class="co">##                        Source</span></span>
<span><span class="co">## 1 Hasenauer &amp; Monserud (1996)</span></span>
<span><span class="co">## 2 Hasenauer &amp; Monserud (1996)</span></span>
<span><span class="co">## 3 Hasenauer &amp; Monserud (1996)</span></span>
<span><span class="co">## 4     Dominguez et al. (2006)</span></span>
<span><span class="co">## 5 Hasenauer &amp; Monserud (1996)</span></span>
<span><span class="co">## 6                  Abies alba</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="harmonizing-equations-and-notation">Harmonizing equations and notation<a class="anchor" aria-label="anchor" href="#harmonizing-equations-and-notation"></a>
</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db_var</span> <span class="op">&lt;-</span> <span class="va">db</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>originalName <span class="op">=</span> <span class="st">"Name"</span>,</span>
<span>                a <span class="op">=</span> <span class="st">"a_cr"</span>,</span>
<span>                b <span class="op">=</span> <span class="st">"b_1cr"</span>,</span>
<span>                c <span class="op">=</span> <span class="st">"b_2cr"</span>,</span>
<span>                d <span class="op">=</span> <span class="st">"b_3cr"</span>,</span>
<span>                e <span class="op">=</span> <span class="st">"c_1cr"</span>,</span>
<span>                f <span class="op">=</span> <span class="st">"c_2cr"</span>,</span>
<span>                Reference <span class="op">=</span> <span class="st">"Source"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Equation <span class="op">=</span> <span class="st">"CrownRatio = 1/(1 + exp(a + b·HD + c·(H/100) + d·DBH^2 + e·BAL + f·ln(CCF)))"</span>,</span>
<span>                Response <span class="op">=</span> <span class="st">"CrownRatio"</span>,</span>
<span>                ResponseDescription <span class="op">=</span> <span class="st">"Crown ratio"</span>,</span>
<span>                Predictor1 <span class="op">=</span> <span class="st">"HD"</span>,</span>
<span>                PredictorDescription1 <span class="op">=</span> <span class="st">"Height-diameter ratio (m·m-1)"</span>,</span>
<span>                Predictor2 <span class="op">=</span> <span class="st">"H"</span>,</span>
<span>                PredictorDescription2 <span class="op">=</span> <span class="st">"Tree height (m)"</span>,</span>
<span>                Predictor3 <span class="op">=</span> <span class="st">"DBH"</span>,</span>
<span>                PredictorDescription3 <span class="op">=</span> <span class="st">"Diameter at breast height (cm)"</span>,</span>
<span>                Predictor4 <span class="op">=</span> <span class="st">"BAL"</span>,</span>
<span>                PredictorDescription4 <span class="op">=</span> <span class="st">"Basal area of larger trees"</span>,</span>
<span>                Predictor5 <span class="op">=</span> <span class="st">"CCF"</span>,</span>
<span>                PredictorDescription5 <span class="op">=</span> <span class="st">"Crown competition factor"</span>,</span>
<span>                Priority <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html" class="external-link">relocate</a></span><span class="op">(</span><span class="va">Reference</span>, .after <span class="op">=</span> <span class="va">PredictorDescription5</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="taxonomic-harmonization">Taxonomic harmonization<a class="anchor" aria-label="anchor" href="#taxonomic-harmonization"></a>
</h2>
<p>Package <strong>traits4models</strong> currently relies on <a href="https://www.worldfloraonline.org/" class="external-link">World Flora Online</a> for
taxonomic harmonization, via package <strong>WorldFlora</strong> <span class="citation">(Kindt 2020)</span> available at <a href="https://cran.r-project.org/package=WorldFlora" class="external-link">CRAN</a>. This
latter package requires a static copy of the World Flora Online
Taxonomic Backbone data that can be downloaded from the <a href="https://www.worldfloraonline.org/" class="external-link">World Flora Online</a> website.
Note that you should use a different DOI reference when reporting your
harmonization procedures. We are using here <a href="https://doi.org/10.5281/zenodo.7460141" class="external-link">v.2024.06</a>. We assume
the user has already downloaded the backbone and stored it in a file
called <em>classification.csv</em>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">WFO_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">DB_path</span>, <span class="st">"../PlantTraitDatabases/WFO_Backbone/classification.csv"</span><span class="op">)</span></span></code></pre></div>
<p>Taxonomic harmonization is done by calling function
<code><a href="../reference/harmonize_taxonomy_WFO.html">harmonize_taxonomy_WFO()</a></code> with a data frame (where notation
and units are already harmonized) and the path to the WFO backbone (we
omit the console output):</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db_post</span> <span class="op">&lt;-</span> <span class="fu">traits4models</span><span class="fu">::</span><span class="fu"><a href="../reference/harmonize_taxonomy_WFO.html">harmonize_taxonomy_WFO</a></span><span class="op">(</span><span class="va">db_var</span>, <span class="va">WFO_file</span><span class="op">)</span></span></code></pre></div>
<p>The function requires that the input data frame contains a column
called <code>originalName</code>, to identify the original taxa names
(additional columns are simply transferred to the output). It performs
both direct and fuzzy matching, which may lead to large processing time
for large datasets. If we inspect the resulting data frame, we will see
the additional columns, informing about accepted names and parent
taxonomic entities:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">db_post</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##       originalName     acceptedName acceptedNameAuthorship   family   genus</span></span>
<span><span class="co">## 1       Abies alba       Abies alba                  Mill. Pinaceae   Abies</span></span>
<span><span class="co">## 2  Fagus sylvatica  Fagus sylvatica                     L. Fagaceae   Fagus</span></span>
<span><span class="co">## 3      Pinus nigra      Pinus nigra             J.F.Arnold Pinaceae   Pinus</span></span>
<span><span class="co">## 4 Pinus sylvestris Pinus sylvestris                     L. Pinaceae   Pinus</span></span>
<span><span class="co">## 5          Quercus          Quercus                     L. Fagaceae Quercus</span></span>
<span><span class="co">## 6            Abies            Abies                  Mill. Pinaceae   Abies</span></span>
<span><span class="co">##   specificEpithet taxonRank       a         b         c            d         e</span></span>
<span><span class="co">## 1            alba   species 2.36476 -0.763000 -0.022850  0.000074049 -0.010180</span></span>
<span><span class="co">## 2       sylvatica   species 3.85373 -0.743000 -0.024680  0.000135686  0.000000</span></span>
<span><span class="co">## 3           nigra   species 2.26205  0.000000 -0.019340  0.000000000 -0.013730</span></span>
<span><span class="co">## 4      sylvestris   species 1.50576 -0.706481 -0.078039  0.000182000 -0.007262</span></span>
<span><span class="co">## 5            &lt;NA&gt;     genus 1.98539 -0.552000 -0.013860 -0.000110736 -0.006850</span></span>
<span><span class="co">## 6            &lt;NA&gt;     genus 2.36476 -0.763000 -0.022850  0.000074049 -0.010180</span></span>
<span><span class="co">##          f</span></span>
<span><span class="co">## 1 -0.27004</span></span>
<span><span class="co">## 2 -0.38434</span></span>
<span><span class="co">## 3 -0.44909</span></span>
<span><span class="co">## 4  0.00000</span></span>
<span><span class="co">## 5 -0.20101</span></span>
<span><span class="co">## 6 -0.27004</span></span>
<span><span class="co">##                                                                       Equation</span></span>
<span><span class="co">## 1 CrownRatio = 1/(1 + exp(a + b·HD + c·(H/100) + d·DBH^2 + e·BAL + f·ln(CCF)))</span></span>
<span><span class="co">## 2 CrownRatio = 1/(1 + exp(a + b·HD + c·(H/100) + d·DBH^2 + e·BAL + f·ln(CCF)))</span></span>
<span><span class="co">## 3 CrownRatio = 1/(1 + exp(a + b·HD + c·(H/100) + d·DBH^2 + e·BAL + f·ln(CCF)))</span></span>
<span><span class="co">## 4 CrownRatio = 1/(1 + exp(a + b·HD + c·(H/100) + d·DBH^2 + e·BAL + f·ln(CCF)))</span></span>
<span><span class="co">## 5 CrownRatio = 1/(1 + exp(a + b·HD + c·(H/100) + d·DBH^2 + e·BAL + f·ln(CCF)))</span></span>
<span><span class="co">## 6 CrownRatio = 1/(1 + exp(a + b·HD + c·(H/100) + d·DBH^2 + e·BAL + f·ln(CCF)))</span></span>
<span><span class="co">##     Response ResponseDescription Predictor1         PredictorDescription1</span></span>
<span><span class="co">## 1 CrownRatio         Crown ratio         HD Height-diameter ratio (m·m-1)</span></span>
<span><span class="co">## 2 CrownRatio         Crown ratio         HD Height-diameter ratio (m·m-1)</span></span>
<span><span class="co">## 3 CrownRatio         Crown ratio         HD Height-diameter ratio (m·m-1)</span></span>
<span><span class="co">## 4 CrownRatio         Crown ratio         HD Height-diameter ratio (m·m-1)</span></span>
<span><span class="co">## 5 CrownRatio         Crown ratio         HD Height-diameter ratio (m·m-1)</span></span>
<span><span class="co">## 6 CrownRatio         Crown ratio         HD Height-diameter ratio (m·m-1)</span></span>
<span><span class="co">##   Predictor2 PredictorDescription2 Predictor3          PredictorDescription3</span></span>
<span><span class="co">## 1          H       Tree height (m)        DBH Diameter at breast height (cm)</span></span>
<span><span class="co">## 2          H       Tree height (m)        DBH Diameter at breast height (cm)</span></span>
<span><span class="co">## 3          H       Tree height (m)        DBH Diameter at breast height (cm)</span></span>
<span><span class="co">## 4          H       Tree height (m)        DBH Diameter at breast height (cm)</span></span>
<span><span class="co">## 5          H       Tree height (m)        DBH Diameter at breast height (cm)</span></span>
<span><span class="co">## 6          H       Tree height (m)        DBH Diameter at breast height (cm)</span></span>
<span><span class="co">##   Predictor4      PredictorDescription4 Predictor5    PredictorDescription5</span></span>
<span><span class="co">## 1        BAL Basal area of larger trees        CCF Crown competition factor</span></span>
<span><span class="co">## 2        BAL Basal area of larger trees        CCF Crown competition factor</span></span>
<span><span class="co">## 3        BAL Basal area of larger trees        CCF Crown competition factor</span></span>
<span><span class="co">## 4        BAL Basal area of larger trees        CCF Crown competition factor</span></span>
<span><span class="co">## 5        BAL Basal area of larger trees        CCF Crown competition factor</span></span>
<span><span class="co">## 6        BAL Basal area of larger trees        CCF Crown competition factor</span></span>
<span><span class="co">##                     Reference Priority</span></span>
<span><span class="co">## 1 Hasenauer &amp; Monserud (1996)        1</span></span>
<span><span class="co">## 2 Hasenauer &amp; Monserud (1996)        1</span></span>
<span><span class="co">## 3 Hasenauer &amp; Monserud (1996)        1</span></span>
<span><span class="co">## 4     Dominguez et al. (2006)        1</span></span>
<span><span class="co">## 5 Hasenauer &amp; Monserud (1996)        1</span></span>
<span><span class="co">## 6                  Abies alba        1</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="checking-harmonized-allometry-data">Checking harmonized allometry data<a class="anchor" aria-label="anchor" href="#checking-harmonized-allometry-data"></a>
</h2>
<p>The packages includes function
<code><a href="../reference/check_harmonized_trait.html">check_harmonized_allometry()</a></code> to check whether a given data
frame conforms in structure and content to what is later required for
parameter table filling:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/check_harmonized_trait.html">check_harmonized_allometry</a></span><span class="op">(</span><span class="va">db_post</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> The data frame is acceptable as harmonized allometry data source.</span></span></code></pre>
<p>In this case, the data set is ready to be used in parameter
estimation. As an example, we can run the same checking function with
the data base before taxonomic harmonization:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/check_harmonized_trait.html">check_harmonized_allometry</a></span><span class="op">(</span><span class="va">db_var</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #BBBB00;">!</span> Required columns missing: acceptedName acceptedNameAuthorship family genus specificEpithet taxonRank</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #BBBB00;">!</span> The data frame is not acceptable as harmonized allometry data source.</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="storing-harmonized-dataset">Storing harmonized dataset<a class="anchor" aria-label="anchor" href="#storing-harmonized-dataset"></a>
</h2>
<p>Harmonized data tables can be stored in <strong>.csv</strong> text
format or compressed <strong>.rds</strong> format. Moreover, all tables
should be stored in the same directory, here in the
<code>Products/harmonized/</code> path.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv2</a></span><span class="op">(</span><span class="va">db_post</span>, <span class="st">"Products/harmonized/tree_crown_ratio_europe.csv"</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="accessing-harmonized-allometry-data">Accessing harmonized allometry data<a class="anchor" aria-label="anchor" href="#accessing-harmonized-allometry-data"></a>
</h2>
<div class="section level3">
<h3 id="list-of-harmonized-allometry-databases">List of harmonized allometry databases<a class="anchor" aria-label="anchor" href="#list-of-harmonized-allometry-databases"></a>
</h3>
<p>As mentioned in the introduction, here it is assumed that a set of
plant allometry databases have been harmonized. In our case, harmonized
data files have been stored in the following path:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">harmonized_allometry_path</span> <span class="op">=</span> <span class="st">"~/OneDrive/EMF_datasets/AllometryDatabases/Products/harmonized"</span></span></code></pre></div>
<p>We can list the set of harmonized sources using:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">allometry_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span>path <span class="op">=</span> <span class="va">harmonized_allometry_path</span>, full.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">allometry_files</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "shrub_crown_area_catalonia.csv"         </span></span>
<span><span class="co">## [2] "shrub_fine_fuel_biomass_catalonia.csv"  </span></span>
<span><span class="co">## [3] "shrub_total_biomass_catalonia.csv"      </span></span>
<span><span class="co">## [4] "tree_bark_thickness_catalonia.csv"      </span></span>
<span><span class="co">## [5] "tree_crown_ratio_europe.csv"            </span></span>
<span><span class="co">## [6] "tree_crown_width_europe.csv"            </span></span>
<span><span class="co">## [7] "tree_foliar_biomass_catalonia.csv"      </span></span>
<span><span class="co">## [8] "tree_foliar_biomass_thom_et_al_2024.csv"</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="querying-allometry-data-for-particular-response-variable">Querying allometry data for particular response variable<a class="anchor" aria-label="anchor" href="#querying-allometry-data-for-particular-response-variable"></a>
</h3>
<p>Before filling any species parameter table, it may be useful to
inspect the amount of information available for particular response.
Package <strong>trait4models</strong> provides function
<code><a href="../reference/get_trait_data.html">get_allometry_data()</a></code>:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fb_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_trait_data.html">get_allometry_data</a></span><span class="op">(</span><span class="va">harmonized_allometry_path</span>, <span class="st">"FoliarBiomass"</span>,</span>
<span>                           progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">fb_data</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##        originalName      acceptedName acceptedNameAuthorship      family</span></span>
<span><span class="co">## 1        Abies alba        Abies alba                  Mill.    Pinaceae</span></span>
<span><span class="co">## 2    Acer campestre    Acer campestre                     L. Sapindaceae</span></span>
<span><span class="co">## 3   Alnus glutinosa   Alnus glutinosa           (L.) Gaertn.  Betulaceae</span></span>
<span><span class="co">## 4    Betula pendula    Betula pendula                   Roth  Betulaceae</span></span>
<span><span class="co">## 5   Castanea sativa   Castanea sativa                  Mill.    Fagaceae</span></span>
<span><span class="co">## 6 Ceratonia siliqua Ceratonia siliqua                     L.    Fabaceae</span></span>
<span><span class="co">##       genus specificEpithet taxonRank</span></span>
<span><span class="co">## 1     Abies            alba   species</span></span>
<span><span class="co">## 2      Acer       campestre   species</span></span>
<span><span class="co">## 3     Alnus       glutinosa   species</span></span>
<span><span class="co">## 4    Betula         pendula   species</span></span>
<span><span class="co">## 5  Castanea          sativa   species</span></span>
<span><span class="co">## 6 Ceratonia         siliqua   species</span></span>
<span><span class="co">##                                         Equation           a        b</span></span>
<span><span class="co">## 1 FoliarBiomass = a·DBH^b·exp(c·BAL)·DBH^(d·BAL) 0.123113793 1.452404</span></span>
<span><span class="co">## 2 FoliarBiomass = a·DBH^b·exp(c·BAL)·DBH^(d·BAL) 0.008176993 1.719401</span></span>
<span><span class="co">## 3 FoliarBiomass = a·DBH^b·exp(c·BAL)·DBH^(d·BAL) 0.016393734 1.468776</span></span>
<span><span class="co">## 4 FoliarBiomass = a·DBH^b·exp(c·BAL)·DBH^(d·BAL) 0.026024811 1.308614</span></span>
<span><span class="co">## 5 FoliarBiomass = a·DBH^b·exp(c·BAL)·DBH^(d·BAL) 0.110916829 1.281197</span></span>
<span><span class="co">## 6 FoliarBiomass = a·DBH^b·exp(c·BAL)·DBH^(d·BAL) 0.118639640 1.625880</span></span>
<span><span class="co">##            c d             Reference      Response ResponseDescription</span></span>
<span><span class="co">## 1  0.0000000 0       Calculated IEFC FoliarBiomass Foliar biomass (kg)</span></span>
<span><span class="co">## 2  0.0000000 0       Calculated IEFC FoliarBiomass Foliar biomass (kg)</span></span>
<span><span class="co">## 3  0.0000000 0       Calculated IEFC FoliarBiomass Foliar biomass (kg)</span></span>
<span><span class="co">## 4  0.0000000 0       Calculated IEFC FoliarBiomass Foliar biomass (kg)</span></span>
<span><span class="co">## 5 -0.0410213 0       Calculated IEFC FoliarBiomass Foliar biomass (kg)</span></span>
<span><span class="co">## 6  0.0000000 0 Montero et al. (2005) FoliarBiomass Foliar biomass (kg)</span></span>
<span><span class="co">##   Predictor1          PredictorDescription1 Predictor2</span></span>
<span><span class="co">## 1        DBH Diameter at breast height (cm)        BAL</span></span>
<span><span class="co">## 2        DBH Diameter at breast height (cm)        BAL</span></span>
<span><span class="co">## 3        DBH Diameter at breast height (cm)        BAL</span></span>
<span><span class="co">## 4        DBH Diameter at breast height (cm)        BAL</span></span>
<span><span class="co">## 5        DBH Diameter at breast height (cm)        BAL</span></span>
<span><span class="co">## 6        DBH Diameter at breast height (cm)        BAL</span></span>
<span><span class="co">##                PredictorDescription2 Priority</span></span>
<span><span class="co">## 1 Basal area of larger trees (m2/ha)        1</span></span>
<span><span class="co">## 2 Basal area of larger trees (m2/ha)        1</span></span>
<span><span class="co">## 3 Basal area of larger trees (m2/ha)        1</span></span>
<span><span class="co">## 4 Basal area of larger trees (m2/ha)        1</span></span>
<span><span class="co">## 5 Basal area of larger trees (m2/ha)        1</span></span>
<span><span class="co">## 6 Basal area of larger trees (m2/ha)        1</span></span></code></pre>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-kindt_worldflora_2020" class="csl-entry">
Kindt, Roeland. 2020. <span>“<span>WorldFlora</span>: <span>An</span>
<span>R</span> Package for Exact and Fuzzy Matching of Plant Names
Against the <span>World</span> <span>Flora</span> <span>Online</span>
Taxonomic Backbone Data.”</span> <em>Applications in Plant Sciences</em>
8 (9): e11388. <a href="https://doi.org/10.1002/aps3.11388" class="external-link">https://doi.org/10.1002/aps3.11388</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Miquel De Cáceres, Nicolas Martin-StPaul, Adriana Tovar, Víctor Granda.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
